# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

"We Is Us" is a web application for visualizing the non-linear timeline of a TV show (working with Apple TV's show that tells its story by navigating back and forth in time). The project stores scene data with timestamps and displays them in a web interface.

### Core Concept

The show presents scenes out of chronological order. Each scene has a timestamp (or delta from time 0) that represents when it occurs in the actual story timeline. This application:
- Stores scene records with their timestamp deltas in a human-readable file format (committed to the repository)
- Displays scenes in various views (chronological, as-aired, timeline visualization)
- Helps viewers understand the non-linear narrative structure
- Allows anyone to browse the timeline data directly on GitHub

## Data Model

### Scene Record Structure
Each scene is a flexible object with:
- **id**: UUID (universally unique identifier) for the scene
- **delta**: Time offset from time 0 (e.g., "5 days", "-2 hours", "3 weeks")
- **text**: Descriptive text accompanying the scene
- **images**: Array of image paths/URLs for the scene
- **tags**: Array of flexible key:value tags (e.g., "episode:1", "location:hospital", "character:John")

### Tag System
Tags provide flexible metadata that can evolve over time:
- Format: `"key:value"` (e.g., `"episode:1"`, `"season:2"`, `"character:Sarah"`)
- Common tag keys: episode, season, location, character, theme
- New tag types can be added as needed without schema changes

## Technology Stack

### Frontend
- **Framework**: Astro (static site generator)
- **Runtime**: Bun (package manager and runtime)
- **Build**: Static site - reads `/data/scenes.json` at build time
- **Hosting**: Static hosting (GitHub Pages, Netlify, Vercel)
- **Deployment**: Push to repo triggers automatic rebuild and deploy

### Data Updates
- Edit `/data/scenes.json` directly (manual or with local tools)
- Commit and push changes
- Hosting platform automatically rebuilds and deploys
- No traditional backend needed for basic functionality

### Database
- **Type**: File-based, human-readable data stored in repository
- **Format**: JSON (recommended for structured data with easy parsing and GitHub diff viewing)
- **Location**: Data files stored in `/data` directory
- **Benefits**: Version-controlled, easily viewable on GitHub, no external database hosting needed

## Project Structure

```
/data
  scenes.json          # Main scene timeline data
/public
  /images              # Scene images (served as static assets)
/src
  /pages
    index.astro        # Main timeline viewer page
astro.config.mjs       # Astro configuration
package.json           # Project dependencies and scripts
```

### Data File Format
See `/data/scenes.json` for example structure. Each scene includes:
- UUID (automatically generated by admin interface)
- Delta (time offset from time 0, supports negative values for flashbacks)
- Text description
- Array of image paths
- Array of tags for flexible categorization

### Data Management
Scene records are managed by editing `/data/scenes.json`:
- Edit JSON file directly or use local tools
- UUIDs should be generated when creating new scenes (use UUID v4)
- After editing, commit and push to trigger rebuild
- Future enhancement: Admin interface could be added as a separate tool

## Development Commands

```bash
# Install dependencies
bun install

# Run development server
bun run dev

# Build static site
bun run build

# Preview production build
bun run preview
```

The dev server runs at http://localhost:4321 by default.

## Key Implementation Notes

- **Scene IDs**: Use UUID v4 for guaranteed uniqueness across all scenes
- **Delta format**: String-based (e.g., "5 days", "-2 hours") for human readability; parser will need to convert to numeric values for sorting
- Negative deltas represent flashbacks (events before time 0)
- Tags are flexible and can be added/modified without schema changes
- Multiple images per scene supported via array
- **Static site**: Data is loaded at build time from `/data/scenes.json`
- **Image paths**: Reference as `/images/filename.jpg` (served from `/public/images/`)
- Data is stored in version-controlled files, making it easy for contributors to submit PRs with corrections
- Data files should be formatted for readability (pretty-printed JSON with 2-space indentation)
- Images should be optimized for web (consider file size)
- **Rebuilds**: Any change to data or code requires rebuild to see updates on live site
